{"ast":null,"code":"import _regeneratorRuntime from\"D:/Blockchain Project/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Blockchain Project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Blockchain Project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from\"react-router-dom\";import Web3 from\"web3\";import SupplyChainABI from\"./artifacts/SupplyChain.json\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AddMed(){var history=useHistory();useEffect(function(){loadWeb3();loadBlockchaindata();},[]);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),currentaccount=_useState2[0],setCurrentaccount=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loader=_useState4[0],setloader=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),SupplyChain=_useState6[0],setSupplyChain=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),MED=_useState8[0],setMED=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),MedName=_useState10[0],setMedName=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),MedDes=_useState12[0],setMedDes=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),MedStage=_useState14[0],setMedStage=_useState14[1];var loadWeb3=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!window.ethereum){_context.next=6;break;}window.web3=new Web3(window.ethereum);_context.next=4;return window.ethereum.enable();case 4:_context.next=7;break;case 6:if(window.web3){window.web3=new Web3(window.web3.currentProvider);}else{window.alert(\"Non-Ethereum browser detected. You should consider trying MetaMask!\");}case 7:case\"end\":return _context.stop();}}},_callee);}));return function loadWeb3(){return _ref.apply(this,arguments);};}();var loadBlockchaindata=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var web3,accounts,account,networkId,networkData,supplychain,i,medCtr,med,medStage;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setloader(true);web3=window.web3;_context2.next=4;return web3.eth.getAccounts();case 4:accounts=_context2.sent;account=accounts[0];setCurrentaccount(account);_context2.next=9;return web3.eth.net.getId();case 9:networkId=_context2.sent;networkData=SupplyChainABI.networks[networkId];if(!networkData){_context2.next=35;break;}supplychain=new web3.eth.Contract(SupplyChainABI.abi,networkData.address);setSupplyChain(supplychain);_context2.next=16;return supplychain.methods.medicineCtr().call();case 16:medCtr=_context2.sent;med={};medStage=[];i=0;case 20:if(!(i<medCtr)){_context2.next=30;break;}_context2.next=23;return supplychain.methods.MedicineStock(i+1).call();case 23:med[i]=_context2.sent;_context2.next=26;return supplychain.methods.showStage(i+1).call();case 26:medStage[i]=_context2.sent;case 27:i++;_context2.next=20;break;case 30:setMED(med);setMedStage(medStage);setloader(false);_context2.next=36;break;case 35:window.alert('The smart contract is not deployed to current network');case 36:case\"end\":return _context2.stop();}}},_callee2);}));return function loadBlockchaindata(){return _ref2.apply(this,arguments);};}();if(loader){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{className:\"wait\",children:\"Loading...\"})});}var redirect_to_home=function redirect_to_home(){history.push('/');};var handlerChangeNameMED=function handlerChangeNameMED(event){setMedName(event.target.value);};var handlerChangeDesMED=function handlerChangeDesMED(event){setMedDes(event.target.value);};var handlerSubmitMED=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var reciept;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();_context3.prev=1;_context3.next=4;return SupplyChain.methods.addMedicine(MedName,MedDes).send({from:currentaccount});case 4:reciept=_context3.sent;if(reciept){loadBlockchaindata();}_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);alert(\"An error occured!!!\");case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function handlerSubmitMED(_x){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Current Account Address:\"}),\" \",currentaccount]}),/*#__PURE__*/_jsx(\"span\",{onClick:redirect_to_home,className:\"btn btn-outline-danger btn-sm\",children:\" HOME\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h5\",{children:\"Add Medicine Order:\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlerSubmitMED,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-sm\",type:\"text\",onChange:handlerChangeNameMED,placeholder:\"Medicine Name\",required:true}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control-sm\",type:\"text\",onChange:handlerChangeDesMED,placeholder:\"Medicine Description\",required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-success btn-sm\",onSubmit:handlerSubmitMED,children:\"Order\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h5\",{children:\"Ordered Medicines:\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Current Stage\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:Object.keys(MED).map(function(key){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:MED[key].id}),/*#__PURE__*/_jsx(\"td\",{children:MED[key].name}),/*#__PURE__*/_jsx(\"td\",{children:MED[key].description}),/*#__PURE__*/_jsx(\"td\",{children:MedStage[key]})]},key);})})]})]});}export default AddMed;","map":{"version":3,"sources":["D:/Blockchain Project/client/src/AddMed.js"],"names":["React","useState","useEffect","useHistory","Web3","SupplyChainABI","AddMed","history","loadWeb3","loadBlockchaindata","currentaccount","setCurrentaccount","loader","setloader","SupplyChain","setSupplyChain","MED","setMED","MedName","setMedName","MedDes","setMedDes","MedStage","setMedStage","window","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","account","net","getId","networkId","networkData","networks","supplychain","Contract","abi","address","methods","medicineCtr","call","medCtr","med","medStage","i","MedicineStock","showStage","redirect_to_home","push","handlerChangeNameMED","event","target","value","handlerChangeDesMED","handlerSubmitMED","preventDefault","addMedicine","send","from","reciept","Object","keys","map","key","id","name","description"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { useHistory } from \"react-router-dom\"\nimport Web3 from \"web3\";\nimport SupplyChainABI from \"./artifacts/SupplyChain.json\"\n\nfunction AddMed() {\n    const history = useHistory()\n    useEffect(() => {\n        loadWeb3();\n        loadBlockchaindata();\n    }, [])\n\n    const [currentaccount, setCurrentaccount] = useState(\"\");\n    const [loader, setloader] = useState(true);\n    const [SupplyChain, setSupplyChain] = useState();\n    const [MED, setMED] = useState();\n    const [MedName, setMedName] = useState();\n    const [MedDes, setMedDes] = useState();\n    const [MedStage, setMedStage] = useState();\n\n\n    const loadWeb3 = async () => {\n        if (window.ethereum) {\n            window.web3 = new Web3(window.ethereum);\n            await window.ethereum.enable();\n        } else if (window.web3) {\n            window.web3 = new Web3(window.web3.currentProvider);\n        } else {\n            window.alert(\n                \"Non-Ethereum browser detected. You should consider trying MetaMask!\"\n            );\n        }\n    };\n\n    const loadBlockchaindata = async () => {\n        setloader(true);\n        const web3 = window.web3;\n        const accounts = await web3.eth.getAccounts();\n        const account = accounts[0];\n        setCurrentaccount(account);\n        const networkId = await web3.eth.net.getId();\n        const networkData = SupplyChainABI.networks[networkId];\n        if (networkData) {\n            const supplychain = new web3.eth.Contract(SupplyChainABI.abi, networkData.address);\n            setSupplyChain(supplychain);\n            var i;\n            const medCtr = await supplychain.methods.medicineCtr().call();\n            const med = {};\n            const medStage = [];\n            for (i = 0; i < medCtr; i++) {\n                med[i] = await supplychain.methods.MedicineStock(i + 1).call();\n                medStage[i] = await supplychain.methods.showStage(i + 1).call();\n            }\n            setMED(med);\n            setMedStage(medStage);\n            setloader(false);\n        }\n        else {\n            window.alert('The smart contract is not deployed to current network')\n        }\n    }\n    if (loader) {\n        return (\n            <div>\n                <h1 className=\"wait\">Loading...</h1>\n            </div>\n        )\n\n    }\n    const redirect_to_home = () => {\n        history.push('/')\n    }\n    const handlerChangeNameMED = (event) => {\n        setMedName(event.target.value);\n    }\n    const handlerChangeDesMED = (event) => {\n        setMedDes(event.target.value);\n    }\n    const handlerSubmitMED = async (event) => {\n        event.preventDefault();\n        try {\n            var reciept = await SupplyChain.methods.addMedicine(MedName, MedDes).send({ from: currentaccount });\n            if (reciept) {\n                loadBlockchaindata();\n            }\n        }\n        catch (err) {\n            alert(\"An error occured!!!\")\n        }\n    }\n    return (\n        <div>\n            <span><b>Current Account Address:</b> {currentaccount}</span>\n            <span onClick={redirect_to_home} className=\"btn btn-outline-danger btn-sm\"> HOME</span>\n            <br />\n            <h5>Add Medicine Order:</h5>\n            <form onSubmit={handlerSubmitMED}>\n                <input className=\"form-control-sm\" type=\"text\" onChange={handlerChangeNameMED} placeholder=\"Medicine Name\" required />\n                <input className=\"form-control-sm\" type=\"text\" onChange={handlerChangeDesMED} placeholder=\"Medicine Description\" required />\n                <button className=\"btn btn-outline-success btn-sm\" onSubmit={handlerSubmitMED}>Order</button>\n            </form>\n            <br />\n            <h5>Ordered Medicines:</h5>\n            <table className=\"table table-bordered\">\n                <thead>\n                    <tr>\n                        <th scope=\"col\">ID</th>\n                        <th scope=\"col\">Name</th>\n                        <th scope=\"col\">Description</th>\n                        <th scope=\"col\">Current Stage</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {Object.keys(MED).map(function (key) {\n                        return (\n                            <tr key={key}>\n                                <td>{MED[key].id}</td>\n                                <td>{MED[key].name}</td>\n                                <td>{MED[key].description}</td>\n                                <td>\n                                    {\n                                        MedStage[key]\n                                    }\n                                </td>\n                            </tr>\n                        )\n                    })}\n                </tbody>\n            </table>\n        </div>\n    )\n}\n\nexport default AddMed\n"]},"metadata":{},"sourceType":"module"}