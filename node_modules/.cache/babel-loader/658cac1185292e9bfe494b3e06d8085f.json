{"ast":null,"code":"import _regeneratorRuntime from\"D:/Blockchain Project/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Blockchain Project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Blockchain Project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from\"react-router-dom\";import Web3 from\"web3\";import SupplyChainABI from\"./artifacts/SupplyChain.json\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Supply(){var history=useHistory();useEffect(function(){loadWeb3();loadBlockchaindata();},[]);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),currentaccount=_useState2[0],setCurrentaccount=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loader=_useState4[0],setloader=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),SupplyChain=_useState6[0],setSupplyChain=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),MED=_useState8[0],setMED=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),MedStage=_useState10[0],setMedStage=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),ID=_useState12[0],setID=_useState12[1];var loadWeb3=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!window.ethereum){_context.next=6;break;}window.web3=new Web3(window.ethereum);_context.next=4;return window.ethereum.enable();case 4:_context.next=7;break;case 6:if(window.web3){window.web3=new Web3(window.web3.currentProvider);}else{window.alert(\"Non-Ethereum browser detected. You should consider trying MetaMask!\");}case 7:case\"end\":return _context.stop();}}},_callee);}));return function loadWeb3(){return _ref.apply(this,arguments);};}();var loadBlockchaindata=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var web3,accounts,account,networkId,networkData,supplychain,i,medCtr,med,medStage;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setloader(true);web3=window.web3;_context2.next=4;return web3.eth.getAccounts();case 4:accounts=_context2.sent;account=accounts[0];setCurrentaccount(account);_context2.next=9;return web3.eth.net.getId();case 9:networkId=_context2.sent;networkData=SupplyChainABI.networks[networkId];if(!networkData){_context2.next=35;break;}supplychain=new web3.eth.Contract(SupplyChainABI.abi,networkData.address);setSupplyChain(supplychain);_context2.next=16;return supplychain.methods.medicineCtr().call();case 16:medCtr=_context2.sent;med={};medStage=[];i=0;case 20:if(!(i<medCtr)){_context2.next=30;break;}_context2.next=23;return supplychain.methods.MedicineStock(i+1).call();case 23:med[i]=_context2.sent;_context2.next=26;return supplychain.methods.showStage(i+1).call();case 26:medStage[i]=_context2.sent;case 27:i++;_context2.next=20;break;case 30:setMED(med);setMedStage(medStage);setloader(false);_context2.next=36;break;case 35:window.alert('The smart contract is not deployed to current network');case 36:case\"end\":return _context2.stop();}}},_callee2);}));return function loadBlockchaindata(){return _ref2.apply(this,arguments);};}();if(loader){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{className:\"wait\",children:\"Loading...\"})});}var redirect_to_home=function redirect_to_home(){history.push('/');};var handlerChangeID=function handlerChangeID(event){setID(event.target.value);};var handlerSubmitRMSsupply=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var reciept;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();_context3.prev=1;_context3.next=4;return SupplyChain.methods.RMSsupply(ID).send({from:currentaccount});case 4:reciept=_context3.sent;if(reciept){loadBlockchaindata();}_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);alert(\"An error occured!!!\");case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function handlerSubmitRMSsupply(_x){return _ref3.apply(this,arguments);};}();var handlerSubmitManufacturing=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(event){var reciept;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:event.preventDefault();_context4.prev=1;_context4.next=4;return SupplyChain.methods.Manufacturing(ID).send({from:currentaccount});case 4:reciept=_context4.sent;if(reciept){loadBlockchaindata();}_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](1);alert(\"An error occured!!!\");case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[1,8]]);}));return function handlerSubmitManufacturing(_x2){return _ref4.apply(this,arguments);};}();var handlerSubmitDistribute=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(event){var reciept;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:event.preventDefault();_context5.prev=1;_context5.next=4;return SupplyChain.methods.Distribute(ID).send({from:currentaccount});case 4:reciept=_context5.sent;if(reciept){loadBlockchaindata();}_context5.next=11;break;case 8:_context5.prev=8;_context5.t0=_context5[\"catch\"](1);alert(\"An error occured!!!\");case 11:case\"end\":return _context5.stop();}}},_callee5,null,[[1,8]]);}));return function handlerSubmitDistribute(_x3){return _ref5.apply(this,arguments);};}();var handlerSubmitRetail=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(event){var reciept;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:event.preventDefault();_context6.prev=1;_context6.next=4;return SupplyChain.methods.Retail(ID).send({from:currentaccount});case 4:reciept=_context6.sent;if(reciept){loadBlockchaindata();}_context6.next=11;break;case 8:_context6.prev=8;_context6.t0=_context6[\"catch\"](1);alert(\"An error occured!!!\");case 11:case\"end\":return _context6.stop();}}},_callee6,null,[[1,8]]);}));return function handlerSubmitRetail(_x4){return _ref6.apply(this,arguments);};}();var handlerSubmitSold=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(event){var reciept;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:event.preventDefault();_context7.prev=1;_context7.next=4;return SupplyChain.methods.sold(ID).send({from:currentaccount});case 4:reciept=_context7.sent;if(reciept){loadBlockchaindata();}_context7.next=11;break;case 8:_context7.prev=8;_context7.t0=_context7[\"catch\"](1);alert(\"An error occured!!!\");case 11:case\"end\":return _context7.stop();}}},_callee7,null,[[1,8]]);}));return function handlerSubmitSold(_x5){return _ref7.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Current Account Address:\"}),\" \",currentaccount]}),/*#__PURE__*/_jsx(\"span\",{onClick:redirect_to_home,className:\"btn btn-outline-danger btn-sm\",children:\" HOME\"}),/*#__PURE__*/_jsx(\"h6\",{children:/*#__PURE__*/_jsx(\"b\",{children:\"Supply Chain Flow:\"})}),/*#__PURE__*/_jsx(\"p\",{children:\"Medicine Order -> Raw Material Supplier -> Manufacturer -> Distributor -> Retailer -> Consumer\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-sm table-dark\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Medicine ID\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Current Processing Stage\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:Object.keys(MED).map(function(key){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:MED[key].id}),/*#__PURE__*/_jsx(\"td\",{children:MED[key].name}),/*#__PURE__*/_jsx(\"td\",{children:MED[key].description}),/*#__PURE__*/_jsx(\"td\",{children:MedStage[key]})]},key);})})]}),/*#__PURE__*/_jsxs(\"h5\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Step 1: Supply Raw Materials\"}),\"(Only a registered Raw Material Supplier can perform this step):-\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlerSubmitRMSsupply,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-sm\",type:\"text\",onChange:handlerChangeID,placeholder:\"Enter Medicine ID\",required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-success btn-sm\",onSubmit:handlerSubmitRMSsupply,children:\"Supply\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h5\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Step 2: Manufacture\"}),\"(Only a registered Manufacturer can perform this step):-\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlerSubmitManufacturing,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-sm\",type:\"text\",onChange:handlerChangeID,placeholder:\"Enter Medicine ID\",required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-success btn-sm\",onSubmit:handlerSubmitManufacturing,children:\"Manufacture\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h5\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Step 3: Distribute\"}),\"(Only a registered Distributor can perform this step):-\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlerSubmitDistribute,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-sm\",type:\"text\",onChange:handlerChangeID,placeholder:\"Enter Medicine ID\",required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-success btn-sm\",onSubmit:handlerSubmitDistribute,children:\"Distribute\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h5\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Step 4: Retail\"}),\"(Only a registered Retailer can perform this step):-\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlerSubmitRetail,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-sm\",type:\"text\",onChange:handlerChangeID,placeholder:\"Enter Medicine ID\",required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-success btn-sm\",onSubmit:handlerSubmitRetail,children:\"Retail\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h5\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Step 5: Mark as sold\"}),\"(Only a registered Retailer can perform this step):-\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlerSubmitSold,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-sm\",type:\"text\",onChange:handlerChangeID,placeholder:\"Enter Medicine ID\",required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-success btn-sm\",onSubmit:handlerSubmitSold,children:\"Sold\"})]}),/*#__PURE__*/_jsx(\"hr\",{})]});}export default Supply;","map":{"version":3,"sources":["D:/Blockchain Project/client/src/Supply.js"],"names":["React","useState","useEffect","useHistory","Web3","SupplyChainABI","Supply","history","loadWeb3","loadBlockchaindata","currentaccount","setCurrentaccount","loader","setloader","SupplyChain","setSupplyChain","MED","setMED","MedStage","setMedStage","ID","setID","window","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","account","net","getId","networkId","networkData","networks","supplychain","Contract","abi","address","methods","medicineCtr","call","medCtr","med","medStage","i","MedicineStock","showStage","redirect_to_home","push","handlerChangeID","event","target","value","handlerSubmitRMSsupply","preventDefault","RMSsupply","send","from","reciept","handlerSubmitManufacturing","Manufacturing","handlerSubmitDistribute","Distribute","handlerSubmitRetail","Retail","handlerSubmitSold","sold","Object","keys","map","key","id","name","description"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { useHistory } from \"react-router-dom\"\nimport Web3 from \"web3\";\nimport SupplyChainABI from \"./artifacts/SupplyChain.json\"\n\nfunction Supply() {\n    const history = useHistory()\n    useEffect(() => {\n        loadWeb3();\n        loadBlockchaindata();\n    }, [])\n\n    const [currentaccount, setCurrentaccount] = useState(\"\");\n    const [loader, setloader] = useState(true);\n    const [SupplyChain, setSupplyChain] = useState();\n    const [MED, setMED] = useState();\n    const [MedStage, setMedStage] = useState();\n    const [ID, setID] = useState();\n\n\n    const loadWeb3 = async () => {\n        if (window.ethereum) {\n            window.web3 = new Web3(window.ethereum);\n            await window.ethereum.enable();\n        } else if (window.web3) {\n            window.web3 = new Web3(window.web3.currentProvider);\n        } else {\n            window.alert(\n                \"Non-Ethereum browser detected. You should consider trying MetaMask!\"\n            );\n        }\n    };\n    const loadBlockchaindata = async () => {\n        setloader(true);\n        const web3 = window.web3;\n        const accounts = await web3.eth.getAccounts();\n        const account = accounts[0];\n        setCurrentaccount(account);\n        const networkId = await web3.eth.net.getId();\n        const networkData = SupplyChainABI.networks[networkId];\n        if (networkData) {\n            const supplychain = new web3.eth.Contract(SupplyChainABI.abi, networkData.address);\n            setSupplyChain(supplychain);\n            var i;\n            const medCtr = await supplychain.methods.medicineCtr().call();\n            const med = {};\n            const medStage = [];\n            for (i = 0; i < medCtr; i++) {\n                med[i] = await supplychain.methods.MedicineStock(i + 1).call();\n                medStage[i] = await supplychain.methods.showStage(i + 1).call();\n            }\n            setMED(med);\n            setMedStage(medStage);\n            setloader(false);\n        }\n        else {\n            window.alert('The smart contract is not deployed to current network')\n        }\n    }\n    if (loader) {\n        return (\n            <div>\n                <h1 className=\"wait\">Loading...</h1>\n            </div>\n        )\n\n    }\n    const redirect_to_home = () => {\n        history.push('/')\n    }\n    const handlerChangeID = (event) => {\n        setID(event.target.value);\n    }\n    const handlerSubmitRMSsupply = async (event) => {\n        event.preventDefault();\n        try {\n            var reciept = await SupplyChain.methods.RMSsupply(ID).send({ from: currentaccount });\n            if (reciept) {\n                loadBlockchaindata();\n            }\n        }\n        catch (err) {\n            alert(\"An error occured!!!\")\n        }\n    }\n    const handlerSubmitManufacturing = async (event) => {\n        event.preventDefault();\n        try {\n            var reciept = await SupplyChain.methods.Manufacturing(ID).send({ from: currentaccount });\n            if (reciept) {\n                loadBlockchaindata();\n            }\n        }\n        catch (err) {\n            alert(\"An error occured!!!\")\n        }\n    }\n    const handlerSubmitDistribute = async (event) => {\n        event.preventDefault();\n        try {\n            var reciept = await SupplyChain.methods.Distribute(ID).send({ from: currentaccount });\n            if (reciept) {\n                loadBlockchaindata();\n            }\n        }\n        catch (err) {\n            alert(\"An error occured!!!\")\n        }\n    }\n    const handlerSubmitRetail = async (event) => {\n        event.preventDefault();\n        try {\n            var reciept = await SupplyChain.methods.Retail(ID).send({ from: currentaccount });\n            if (reciept) {\n                loadBlockchaindata();\n            }\n        }\n        catch (err) {\n            alert(\"An error occured!!!\")\n        }\n    }\n    const handlerSubmitSold = async (event) => {\n        event.preventDefault();\n        try {\n            var reciept = await SupplyChain.methods.sold(ID).send({ from: currentaccount });\n            if (reciept) {\n                loadBlockchaindata();\n            }\n        }\n        catch (err) {\n            alert(\"An error occured!!!\")\n        }\n    }\n    return (\n        <div>\n            <span><b>Current Account Address:</b> {currentaccount}</span>\n            <span onClick={redirect_to_home} className=\"btn btn-outline-danger btn-sm\"> HOME</span>\n            <h6><b>Supply Chain Flow:</b></h6>\n            <p>Medicine Order -&gt; Raw Material Supplier -&gt; Manufacturer -&gt; Distributor -&gt; Retailer -&gt; Consumer</p>\n            <table className=\"table table-sm table-dark\">\n                <thead>\n                    <tr>\n                        <th scope=\"col\">Medicine ID</th>\n                        <th scope=\"col\">Name</th>\n                        <th scope=\"col\">Description</th>\n                        <th scope=\"col\">Current Processing Stage</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {Object.keys(MED).map(function (key) {\n                        return (\n                            <tr key={key}>\n                                <td>{MED[key].id}</td>\n                                <td>{MED[key].name}</td>\n                                <td>{MED[key].description}</td>\n                                <td>\n                                    {\n                                        MedStage[key]\n                                    }\n                                </td>\n                            </tr>\n                        )\n                    })}\n                </tbody>\n            </table>\n            <h5><b>Step 1: Supply Raw Materials</b>(Only a registered Raw Material Supplier can perform this step):-</h5>\n            <form onSubmit={handlerSubmitRMSsupply}>\n                <input className=\"form-control-sm\" type=\"text\" onChange={handlerChangeID} placeholder=\"Enter Medicine ID\" required />\n                <button className=\"btn btn-outline-success btn-sm\" onSubmit={handlerSubmitRMSsupply}>Supply</button>\n            </form>\n            <hr />\n            <br />\n            <h5><b>Step 2: Manufacture</b>(Only a registered Manufacturer can perform this step):-</h5>\n            <form onSubmit={handlerSubmitManufacturing}>\n                <input className=\"form-control-sm\" type=\"text\" onChange={handlerChangeID} placeholder=\"Enter Medicine ID\" required />\n                <button className=\"btn btn-outline-success btn-sm\" onSubmit={handlerSubmitManufacturing}>Manufacture</button>\n            </form>\n            <hr />\n            <br />\n            <h5><b>Step 3: Distribute</b>(Only a registered Distributor can perform this step):-</h5>\n            <form onSubmit={handlerSubmitDistribute}>\n                <input className=\"form-control-sm\" type=\"text\" onChange={handlerChangeID} placeholder=\"Enter Medicine ID\" required />\n                <button className=\"btn btn-outline-success btn-sm\" onSubmit={handlerSubmitDistribute}>Distribute</button>\n            </form>\n            <hr />\n            <br />\n            <h5><b>Step 4: Retail</b>(Only a registered Retailer can perform this step):-</h5>\n            <form onSubmit={handlerSubmitRetail}>\n                <input className=\"form-control-sm\" type=\"text\" onChange={handlerChangeID} placeholder=\"Enter Medicine ID\" required />\n                <button className=\"btn btn-outline-success btn-sm\" onSubmit={handlerSubmitRetail}>Retail</button>\n            </form>\n            <hr />\n            <br />\n            <h5><b>Step 5: Mark as sold</b>(Only a registered Retailer can perform this step):-</h5>\n            <form onSubmit={handlerSubmitSold}>\n                <input className=\"form-control-sm\" type=\"text\" onChange={handlerChangeID} placeholder=\"Enter Medicine ID\" required />\n                <button className=\"btn btn-outline-success btn-sm\" onSubmit={handlerSubmitSold}>Sold</button>\n            </form>\n            <hr />\n        </div>\n    )\n}\n\nexport default Supply\n"]},"metadata":{},"sourceType":"module"}